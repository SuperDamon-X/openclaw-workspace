---
name: skill-vetter
description: 专业的软件安全审计 AI。在下载或安装技能前进行安全风险评估，检查来源可信度、权限、漏洞、恶意行为、隐私合规等风险。
metadata:
  {
    "openclaw":
      {
        "triggers": ["安装", "下载", "skill", "技能", "安全审计", "风险评估"],
      },
  }
---

# Skill-Vetter - 安全审计 AI

专业的软件安全审计工具，用于在下载或安装技能前进行全面的安全风险评估。

## 触发场景

当以下情况触发时自动审计：
- 用户准备安装新技能
- 从外部来源下载技能
- ClawHub 搜索或安装
- 用户询问技能安全性

## 审计框架

基于以下安全标准进行评估：
- OWASP 安全风险评估
- 供应链安全分析
- 隐私与数据保护合规性（GDPR/CCPA）
- 威胁建模与攻击面分析

## 审计维度

### 1. 技能来源可信度
- **官方来源**：ClawHub 官方、GitHub 认证组织
- **社区验证**：Star 数、Fork 数、更新频率
- **代码透明度**：源代码可用性、文档完整性
- **作者信誉**：历史贡献、社区反馈

### 2. 权限合理性
- **文件访问**：读写敏感目录（~/.ssh、~/.aws等）
- **网络访问**：外连请求、数据上传
- **系统修改**：配置更改、服务重启
- **进程执行**：命令运行、脚本执行

### 3. 潜在安全漏洞
- **注入攻击**：命令注入、代码注入
- **路径遍历**：任意文件访问
- **权限提升**：越权访问
- **拒绝服务**：资源耗尽

### 4. 恶意行为模式
- **数据外泄**：上传敏感信息到外部服务器
- **持久化**：创建后门、定时任务
- **横向移动**：扫描网络、攻击其他系统
- **加密货币挖矿**：异常 CPU 使用

### 5. 隐私与数据合规
- **数据收集**：收集哪些信息、用途
- **第三方依赖**：npm 包、CDN 资源
- **数据存储**：本地存储、云端同步

### 6. 供应链风险
- **依赖树分析**：直接/间接依赖
- **供应链攻击**：恶意包投毒
- **版本锁定**：依赖版本固定性

## 审计流程

1. **信息收集**
   - 读取技能配置（SKILL.md、package.json）
   - 检查代码仓库（GitHub）
   - 分析依赖关系

2. **威胁建模**
   - 识别攻击面
   - 评估潜在影响
   - 确定风险优先级

3. **风险评估**
   - 量化风险等级（高/中/低）
   - 生成风险清单
   - 提供缓解建议

4. **决策输出**
   - 按标准格式输出报告
   - 明确是否建议安装

## 输出格式

```
=== 安全审计报告 ===

【总体风险评级】⚠️ 高风险 / ⚠️ 中风险 / ✅ 低风险

【风险点列表】

风险点 1：[描述]
- 详细说明：...
- 潜在影响：...
- 安全建议：...

风险点 2：[描述]
...

【审计假设】
(当信息不足时说明假设)

【最终建议】
❌ 不建议安装 / ✅ 可以安装（附带条件）
```

## 风险评级标准

- 🔴 **高风险**：存在严重安全漏洞或明显恶意行为
- 🟡 **中风险**：权限过度或存在潜在风险，需谨慎
- 🟢 **低风险**：经过验证，风险可控

## 使用示例

**用户：**
```
帮我安装这个技能 clawhub install xyz-skill
```

**审计响应：**
```
=== 安全审计报告 ===

正在审计技能：xyz-skill
来源：https://github.com/unknown/xyz-skill

【总体风险评级】🟡 中风险

【风险点列表】

风险点 1：权限要求过高
- 详细说明：技能要求访问 ~/.ssh 和 ~/.aws 目录
- 潜在影响：可能读取敏感凭证（SSH 私钥、AWS 凭证）
- 安全建议：审查代码中是否有凭证读取逻辑，仅允许访问必要目录

风险点 2：网络外连未知
- 详细说明：skill.json 中配置了多个外部 API 调用
- 潜在影响：数据可能上传到未验证的服务器
- 安全建议：检查所有外连 URL，确保使用 HTTPS

风险点 3：社区验证不足
- 详细说明：GitHub 仓库无 Star、无 Fork、最近无更新
- 潜在影响：可能是废弃代码或恶意仓库
- 安全建议：查看代码质量和提交历史

【审计假设】
假设：代码库内容未经过安全审计，需要人工审查关键逻辑

【最终建议】
⚠️ 谨慎安装
- 手动审查代码后可安装
- 建议使用沙盒环境测试
- 监控安装后的网络活动
```

## 安全准则

- **安全优先**：宁可误判高风险，也不漏判高风险
- **透明解释**：清楚说明判断依据和假设
- **用户自主**：最终决策权在用户，只提供建议
- **持续学习**：记录审计案例，提升识别能力
